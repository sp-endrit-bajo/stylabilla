# Contributing

## Contents
- [Setup](#setup)
- [File Structure](#file-structure)
- [Component Definition of Done](#component-definition-of-done)
- [Accessibility testing](#accessibility-testing)
- [Style Conventions](#style-conventions)
- [Making Contributions](#making-contributions)
- [Breaking Changes](#breaking-changes)

## Setup
- `nvm use`
- `yarn`
- `yarn start` (note that the css will live reload but at this stage you will need to refresh for the comments)

For building the production css: `yarn build`.

## File Structure
- `src` - the actual styles that make up Stylabilla
- `dist` - automatically generated production version of the stylabilla css
- `docs-builder` - the [kss](https://github.com/kss-node/kss-node) builder that creates the living styleguide documentation
- `docs` - documentation that is automatically generated by the `docs-builder`, and served by `yarn start`

## Component Definition of Done

For a component to be accepted into Stylabilla, it needs to meet the following requirements.
- Styles follow the conventions below
- Accessibility has been considered
    - Components are navigable by keyboard only
    - Appropriate alt and [ARIA attributes](https://w3c.github.io/using-aria/) are included
    - Semantic HTML is used
    - Acessibility [tests](#accessibility-testing) are passing
- Performance has been considered
    - Minimal markup is used
    - Animations follow performance [best practices](https://developers.google.com/web/fundamentals/design-and-ui/animations/animations-and-performance)
    - Animations are minimal and scoped to just the properties that are changing
- Browser support [requirements](https://usabilla.atlassian.net/wiki/display/DEV/Browser+Support+Strategy) are adhered to. This styleguide is used both in our application and in our customer facing widgets so needs to support the largest audience.
- The compiled css has been checked and there is no unnecessary repetition, deeply nested classes etc.
- The component works across all device widths, and is built mobile first.
- Documentation is included, which:
    - Browsers support information is added to each component.
    - Demonstrates examples of the component with different classes, children, or using different elements as parents
    - Includes ARIA attributes
    - Is readable and looks consistent with other components when compiled into the guide
    - Follows the [kss-node specifications](https://github.com/kss-node/kss/blob/spec/SPEC.md)

## Accessibility testing

For a component to be accepted into Stylabilla it needs to pass the accessibility tests.
In order to run the accessibility tests of a certain section you need to run the following commands:

```bash
# Need to have the server running
yarn start
# Run the tests on the sub-section 'Colors' of the section 'Buttons'
yarn test:accessibility buttons.colors
```

If we want to test the accessibility of all the sections we just need to run:

```bash
# Need to have the server running
yarn start
# Run the tests on all the sections
yarn test:accessibility
```

If there are any accessibility errors or warnings you'll see an output similar to the following:

```bash
  ####### http://localhost:8080/item-buttons-colors.html #######

  • Error: <button class="sb-btn sb-btn--primary ">Button</button>
     This element has insufficient contrast at this conformance level. Expected a contrast ratio of at least 4.5:1, but text in this element has a contrast ratio of 2.37:1. Recommendation: change background to #00728b.

  • Error: <button class="sb-btn sb-btn--primary sb-btn--danger">Button</button>
     This element has insufficient contrast at this conformance level. Expected a contrast ratio of at least 4.5:1, but text in this element has a contrast ratio of 2.06:1. Recommendation: change background to #686868.
```

If the tests are successful the output will be:

```bash
  ####### http://localhost:8080/item-buttons-colors.html #######

  Test passed!
```

## Style Conventions

All classes must be prefixed with `sb-`.

We follow the [BEM](https://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/) naming convention for class names. This looks like:
```
.block {}
.block__element {}
.block--modifier {}
```

For example:
```
.site-search {} /* Block */
.site-search__field {} /* Element */
.site-search--full {} /* Modifier */
```

Use class selectors wherever possible. Use attribute selectors only if absolutely necessary and do not use ids or element/tag selectors.

[Nesting selectors is bad](http://markdotto.com/2015/07/20/css-nesting/). We only allow 2 levels max.

Individual components should not make assumptions about their layout (e.g. by setting margins, padding or position).

Avoid applying styles in a generic class and then undoing them in a more specific class.

If you haven't read Harry Roberts' article about [code smells in css](https://csswizardry.com/2012/11/code-smells-in-css/), please read it before contributing :)


## Making Contributions

We use a simple [Feature Branch Workflow](https://www.atlassian.com/git/tutorials/comparing-workflows#feature-branch-workflow), where all changes are made in feature branches which are then pull requested into `master`. Each pull request must be assigned to the team, and reviewed by at least one person. If the changes are significant, then the reviewer should be someone who is experienced or knows the project well. Please include a screenshot of your change (if your change is visual) and/or a [gif](http://recordit.co/) (if your change is interactive) to aid the review process.

Branches should be named for the feature they implement. For example `button-ui` or `dropdown-animate`. Ideally it shouldn't include more than two or three words.

Write [good semantic commit messages](https://github.com/angular/angular.js/blob/master/CONTRIBUTING.md#-git-commit-guidelines). For example:
```
docs(contributing): add documentation for contribution standards

Add documentation to help developers follow the same standards for making changes to this repository.
```
**Note that commit messages can create a release so please read the following!**

## Semantic Versioning and Releases

Stylabilla follows [semantic versioning](http://semver.org). Applications using Stylabilla should be able to update patch and minor versions without requiring any changes to their code.
We also use [semantic-release](https://github.com/semantic-release/semantic-release), meaning that when a pull request is merged, the following will occur:

Commit Type | NPM Release
--- | ---
`fix` | patch
`feat` | minor/feature
`BREAKING CHANGE` (in commit body) | major/breaking

Avoid making breaking changes if possible. The general rule is: **if it requires consumers to make changes to their code, then it's a breaking change**.

This includes:

- Removing or renaming existing classes
- Removing or renaming existing mixins, variables or anything else that is able to be imported by a project
- Modifying properties of existing classes in a way that could break standard web layouts implemented with those classes

New CSS classes are not considered breaking changes. Changes to existing classes that do not impact layout are also not considered breaking changes (e.g. font-weight, color, border-color, box-shadow, etc).
